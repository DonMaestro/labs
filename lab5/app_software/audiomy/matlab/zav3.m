%h = [0.2718 0.1649 0.1396 0.1284 0.1221 0.1181 0.1154 0.1133,...
% 0.1118 0.1105 0.1095 0.1087 0.1080 0.1074 0.1069 0.1064 0.1061,...
% 0.1057 0.1054 0.1051 0.1049];

h = [0 0.0055 0.0109 0.0162 0.0214 0.0262 0.0309 0.0351 0.0390,...
   0.0425 0.0455 0.0480 0.0499 0.0514 0.0522 0.0525 0.0522 0.0514,...
   0.0499 0.0480 0.0455 0.0425 0.0390 0.0351 0.0309 0.0262 0.0214,...
   0.0162 0.0109 0.0055 0.0000];

[a, Fs] = audioread('IDBones.wav');


start = 5e6;
endd = 5.001e6;

figure(1)
plot(h);
title(sprintf("h"));

figure(2)
subplot(1, 2, 1);
plot(a(start:endd,1));
title("fun");

subplot(1, 2, 2);
res(:,1) = conv(a(:,1), h);
res(:,2) = conv(a(:,2), h);
plot(res(start:endd,1));
title(sprintf("conv(fun, h)"));

audiowrite('res.wav', res, Fs)

